# React组件化开发（二）

## 一、React性能优化SCU

### 1. React更新机制

![react-render-progress](https://gitee.com/edward_west/image-store/raw/master/study-frontend/react/learn-react/react-render-progress.png)

![react-update-mechanism](https://gitee.com/edward_west/image-store/raw/master/study-frontend/react/learn-react/react-update-mechanism.png)

### 2. React的更新流程

- React在props或state发生改变时，会调用React的render方法，会创建一颗不同的树
- React需要基于这两颗不同的树之间的差别来判断如何有效的更新UI
  - 如果一棵树参考另外一棵树进行完全更新，该算法的复杂度为O(n^2)，其中n是树中元素的数量

- React对这个算法进行了优化，将其优化成了O(n)，如何优化呢
  - 同层节点直接相互比较，不会跨节点比较
  - 不同类型的节点，会产生不同的树结构
  - 开发中，可以通过key来指定哪些节点在不同的渲染下保持稳定

### 3. keys的优化

- 方式一：在最后位置插入数据
  - 这种情况，有无key意义不大

- 方式二：在前面插入数据
  - 这种中法，在没有key的情况下，所有的li都需要进行修改

- 当子元素拥有key时，React使用key来匹配原有树上的子元素以及最新树上的子元素
- key的注意事项
  - key应该是唯一的
  - key不要使用随机数（随机数在下一次render时，会重新生成一个数字）
  - 使用index作为key，对性能是没有优化的

### 4. render函数被调用

## 二、获取DOM方式refs

## 三、受控和非受控组件

## 四、React的高阶组件

## 五、portals和fragment

## 六、StrictMode严格模式
