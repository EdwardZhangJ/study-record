# React组件化开发（一）

## 一、React组件化开发

### 1. 什么是组件化开发？

- 组件化是一种分而治之的思想
  - 如果将一个页面中所有的处理逻辑全部放在一起，处理起来就会变得非常复杂，而且不利于后续的管理以及扩展
  - 但是，将一个复杂的页面拆分成多个功能块，每个块只负责自己这部分独立的功能，这样既方便开发，又方便维护

- 需要通过组件化的思想来思考整个应用程序
  - 将一个完整的页面分成很多歌组件
  - 每个组件都用于实现页面的一个功能块
  - 每一个组件又可以进行细分
  - 组件本身又可以在多个地方进行复用

### 2. React的组件化

- 组件化时React的核心思想，也是后续课程的重点
  - 组件化提供了一种抽象，让我们可以开发出一个个独立可复用的小组件来构造我们的应用
  - 任何的应用都会被抽象成一颗组件树

- 组件化思想的应用
  - 尽可能的将页面拆分成一个个小的、可复用的组件
  - 让代码更加方便组织和管理，并且扩展性也更强

- React的组件相当于Vue更加的灵活和多样，按照不同的方式可以分成很多类组件
  - 根据组件的定义方式，可以分为函数组件（Functional Component）和类组件（Class Component）
  - 根据组件内部是否有状态需要维护，可以分为无状态组件（Stateless Component）和有状态组件（Stateful Component）
  - 根据组件的不同职责，可以分为容器型组件（Container Component）和展示型组件（Presentational Component）

- 这些概念有很多重叠，最主要是关注数据逻辑和UI展示的分离
  - 函数组件、无状态组件、展示型组件主要关注UI的展示
  - 类组件、有状态组件、容器型组件主要关注数据逻辑

### 3. 类组件

- 类组件的定义要求
  - 组件的名称是大写字符开头（无论类组件还是函数组件）
  - 类组件需要继承自 React.Component
  - 类组件必须实现render函数

- 在ES6之前，可以通过create-react-class模块来定义类组件，但是目前官网建议使用ES6的class类定义
- 使用class定义一个组件
  - contrustor()是可选的，通常在constructor中初始化一些数据
  - this.state中维护的就是组件内部的数据
  - render()方法是class组件中唯一必须实现的方法

```js
export class App extends Component {
  render() {
    return (
      <div>
        <div>App</div>
      </div>
    )
  }
}
```

#### 3.1 render函数的返回值

- 当render被调用时，会检查this.props和this.state的变化并返回以下类型之一
- React元素
  - 通常通过JSX创建
  - 例如，`<div />`会被React渲染为DOM节点，`<MyComponent />`会被React渲染为自定义组件
  - 无论是`<div />`还是`<MyComponent />`均为React元素

- 数组或fragments：使得render方法可以返回多个元素
- Portals：可以渲染子节点到不同的DOM子树中
- 字符串或数值类型：在DOM中会被渲染文本节点
- 布尔类型或null：什么都不会被渲染

```jsx
render() {
    // const {message} = this.state
    // 1. react元素：通过jsx编写的代码机会被编译成React.createElement()，所以返回的就是一个React元素
    // return <h2>{message}</h2>

    // 2. 组件或者 fragment：返回的是一个组件或者是一个fragment
    // return ['abc', 'cba', 'nba']
    // return [
    //   <h1>h1元素</h1>,
    //   <h2>h2元素</h2>,
    //   <div>哈哈哈</div>,
    // ]

    // 3. 字符串/数字：返回的是字符串或者数字
    // return '123'
    return 1111
  }
```

### 4. 函数组件

- 函数组件是使用function来进行定义的函数，只是这个函数会返回和类组件中render函数返回一样的内容
- 函数组件有自己的特点（与hooks不一样）
  - 没有生命周期，也会被更新并挂载，但是没有生命周期函数
  - this关键字不能指向组件实例（因为没有组件实例）
  - 没有内部状态（state）

```jsx
export default function App() {
  // 返回值：和类组件中render函数返回的是一致
  return <h1>App Functional Component</h1>
}
```

## 二、React组件生命周期

### 1. 认识生命周期

- React组件也有自己的生命周期，了解组件的生命周期可以让我们在最合适的地方完成自己想要的功能
- 生命周期和生命周期函数的关系
- 生命周期是一个抽象的概念，在生命周期的整个过程，分成了很多个阶段
  - 装载阶段（Mount），组件第一次在DOM树中被渲染的过程
  - 更新过程（Update），组件已经发生了更新时，就会回调
  - 卸载过程（UnMount），组件从DOM树中被移除的过程

- React内部为了告诉我们当前处于哪些阶段，会对组件内部实现的某些函数进行回调，这些函数就是生命周期函数
  - 实现componentDidMount函数：组件已经挂载到DOM上时，就会回调
  - 实现componentDidUpdate函数：组件已经发生了更新时，就会回调
  - 实现componentWillUnmount函数：组件将要被卸载时，就会回调

- 谈React生命周期时，主要谈的类的生命周期，因为函数式组件是没有生命周期函数的。（后面可以通过hooks来模拟一些生命周期的回调）

## 三、React组件间的通信

## 四、React组件插槽用法

## 五、React非父子的通信

## 六、setState的使用详解
